# Avito | Dynamic User Segmentation Service | Тестовое задание

Проект представляет собой реализовать сервис,
хранящий пользователя и сегменты
в которых он состоит
(создание, изменение, удаление сегментов, а также добавление и удаление пользователей в сегмент)


## Инструкция по запуску приложения

### 0. Загрузка репозитория

------------

```shell
git clone https://github.com/shamank/user-segmentation-service.git
cd user-segmentation-service
```


### 1. Сборка проекта

------------

Для сборки проекта необходимо использовать следующий синтаксис

```shell
go build -o /path/to/bin ./cmd/main.go
```
где:
- `/path/to/bin` - путь до скомпилированного файла <br>

Можно также использовать утилиту `make`:
```shell
make build
```
Тогда скомпилированное приложение будет лежать в папке `./.bin`

### 2. Запуск приложения

------------

```shell
/path/to/bin
```
С помощью утилиты `make`:
```shell
make run
```
где:
- `/path/to/bin` - путь до скомпилированного файла


### 3. Сборка и запуск с помощью Docker

------------

Сборка **Docker**-образа с помощью `make` выглядит следующим образом:
```shell
docker-compose build
docker-compose up -d
```
Либо же с помощью утилиты `make`
```shell
make docker
```

## Требования:
- Go, v. 1.21+ (или Docker)
- Docker (optional)
- cmake (optional)

### Вопросы, которые появились во время выполнения задания
Не очень было понятно - пользователи уже должны быть в базе данных или 
добавлять их по мере запросов? В ТЗ я четкого указания не нашел, только:

"...реализовать сервис, хранящий **пользователя** и сегменты.."
на основании чего я сделал вывод, что пользователи уже должны быть в базе данных
(т.е. нужна отдельная таблица для них)

Также было затруднение с хранением истории пользователя.
Из-за того, что необходимо было реализовать метод удаления сегмента, то в таблице
*user_segment_history* невозможно было бы хранить segment_id как вторичный ключ.
Можно было не связывать эти таблицы, но я принял решение реализовать *soft delete* - 
т.е. сегмент при удалении просто скрывается с помощью столбца deleted_at